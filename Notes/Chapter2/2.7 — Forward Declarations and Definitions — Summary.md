# 2.7 — Forward Declarations and Definitions — Summary

---

# The Problem: Order Matters

C++ compiles code **sequentially (top to bottom)**.

If a function is called before it is defined, the compiler does not yet know it exists and produces an error:

```
identifier not found
```

Example problem:

```cpp
int main()
{
    add(3, 4); // compiler hasn't seen add yet
}

int add(int x, int y)
{
    return x + y;
}
```

---

# Best Practice When Debugging

When multiple compile errors appear:

- Fix the **first error listed**
    
- Recompile
    
- Repeat
    

Later errors are often consequences of earlier ones.

---

# Two Ways to Fix the Problem

## Option 1 — Reorder Definitions

Define the function before it is used.

```cpp
int add(int x, int y)
{
    return x + y;
}

int main()
{
    add(3, 4);
}
```

This works, but:

- Becomes difficult in large programs
    
- Impossible when functions call each other
    
- Impossible when functions live in different files
    

---

## Option 2 — Use a Forward Declaration (Preferred)

A **forward declaration** tells the compiler that a function exists before its body is defined.

It uses a **function declaration (prototype)**:

```cpp
int add(int x, int y); // declaration (no body)
```

Then later:

```cpp
int add(int x, int y)
{
    return x + y;
}
```

Now the compiler knows about `add` before encountering the call.

---

# Function Declaration (Prototype)

A function declaration contains:

- Return type
    
- Function name
    
- Parameter types
    
- Optional parameter names
    
- Ends with a semicolon
    
- No function body
    

Example:

```cpp
int add(int x, int y);
```

Parameter names are optional:

```cpp
int add(int, int);
```

### Best Practice

Include parameter names in declarations for clarity and documentation.

---

# Why Forward Declarations Matter

Forward declarations are especially important when:

- Functions are defined in different files
    
- Functions call each other (circular dependency)
    
- You want order-independent organization
    

They are essential for multi-file programs.

---

# What If You Declare But Never Define?

If a function is:

- Declared but never called → program compiles and runs
    
- Declared and called but never defined → compilation succeeds, **linking fails**
    

This produces a **linker error** (“unresolved external symbol”).

---

# Declaration vs Definition

Understanding the difference is critical.

## Declaration

Tells the compiler an identifier exists and describes its type.

Examples:

```cpp
int add(int x, int y); // pure declaration
int x;                 // variable declaration (also definition)
```

---

## Definition

A declaration that:

- Implements a function, or
    
- Instantiates a variable
    

Examples:

```cpp
int add(int x, int y)
{
    return x + y;
}

int x; // defines variable x
```

### Key Rule

All definitions are declarations.  
Not all declarations are definitions.

---

# Pure Declaration

A declaration that is **not** a definition.

Example:

```cpp
int add(int x, int y); // no body
```

---

# The One Definition Rule (ODR)

The ODR has three main parts:

## 1. Within a File

Each function, variable, type, or template may have **only one definition per scope**.

Violations cause **compile-time errors**.

---

## 2. Within a Program

Each function or variable may have **only one definition across all files**.

Violations cause **link-time errors**.

---

## 3. Special Exceptions

Types, templates, inline functions, and inline variables may have multiple identical definitions across files.

(Advanced topic.)

---

# What Violates the ODR?

Invalid:

```cpp
int add(int x, int y) { return x + y; }
int add(int x, int y) { return x + y; } // redefinition
```

Valid:

```cpp
int main()
{
    int x{};
}

int add(int x, int y) // different scope
{
    return x + y;
}
```

Same name, different scope → allowed.

---

# Compile vs Link Failures

Understanding error types is important:

- Wrong number of arguments → **compile error**
    
- Declaration exists but definition missing → **link error**
    
- Duplicate definition → **compile or link error (ODR violation)**
    

---

# Key Concepts Recap

### Function Prototype

A declaration describing a function’s signature, without a body.

### Forward Declaration

A declaration that informs the compiler an identifier exists before it is defined.

### Definition

Actual implementation (function body) or instantiation (variable).

### One Definition Rule (ODR)

Each function/variable must have exactly one definition per scope and per program.

---

# Big Picture

Forward declarations:

- Allow flexible code organization
    
- Enable multi-file programs
    
- Resolve circular dependencies
    
- Separate interface from implementation
    

Understanding declarations vs definitions and the ODR is foundational for writing larger, modular C++ programs.
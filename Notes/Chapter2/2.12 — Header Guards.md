# 2.12 â€” Header Guards
### **The Duplicate Definition Problem**

In C++, the **One Definition Rule (ODR)** states that identifiers (variables, functions) generally cannot be defined more than once in the same file.

A problem arises when header files include _other_ header files.

- **Scenario:** You have `main.cpp` which includes `math.h` and `geometry.h`.
    
- **The Conflict:** If `geometry.h` _also_ includes `math.h`, then `main.cpp` effectively receives two copies of `math.h`.
    
- **The Result:** The compiler sees duplicate definitions and throws an error.
    

### **The Solution: Header Guards**

Header guards (or include guards) are conditional compilation directives that ensure the preprocessor only includes a file's content once per translation unit.

**Standard Syntax:**

It uses a unique identifier (usually the filename in caps like `FILENAME_H`) to "flag" that the file has been seen.

```cpp
#ifndef SQUARE_H   // 1. If SQUARE_H is NOT defined...
#define SQUARE_H   // 2. Define SQUARE_H now.

// ... Header content (declarations) goes here ...

#endif             // 3. End of the conditional block.
```

**How it works:**

1. **First Inclusion:** The check `#ifndef SQUARE_H` is true. The preprocessor defines `SQUARE_H` and includes the code.
    
2. **Second Inclusion:** The check `#ifndef SQUARE_H` returns false (because we defined it the first time). The preprocessor skips everything until `#endif`.
    

### **Scope of Protection**

It is vital to understand what header guards do and do _not_ do:

- **What they DO:** Prevent a header from being pasted multiple times into a **single** `.cpp` file (fixing the compile error).
    
- **What they DO NOT:** Prevent a header from being included into **multiple different** `.cpp` files.
    
    - _Implication:_ If you define a function body in a header file, header guards won't save you from a **Linker Error**. `main.cpp` and `other.cpp` will both have a definition of that function, causing a collision at the linking stage.
        

### **Modern Alternative: `#pragma once`**

Most modern compilers support a simpler directive that achieves the same goal:

```cpp
#pragma once
// Header content
```

- **Pros:** Shorter, less error-prone (no need to invent unique names), faster.
    
- **Cons:** Not officially part of the C++ standard (though support is ubiquitous), can theoretically fail if you have multiple copies of the exact same file in different directories.
    
- **Verdict:** Google style often prefers standard guards; many others prefer `#pragma once`. Both are acceptable.
    

### **Summary of Best Practices**

1. **Always Guard:** Every header file should have guards, even if it only contains simple declarations.
    
2. **Naming Convention:** If using standard guards, use unique names (e.g., `PROJECT_PATH_FILE_H`) to avoid collisions with other libraries.
    
3. **Declarations Only:** Keep function definitions out of headers (mostly) to avoid Linker ODR violations.
